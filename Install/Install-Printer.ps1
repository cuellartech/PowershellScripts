[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms")
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Drawing")
[void] [System.Windows.Forms.Application]::EnableVisualStyles()#Hide Console Function
function hideConsole{
	#Hide Console after stating form
	Add-Type -Name Window -Namespace Console -MemberDefinition '
	[DllImport("Kernel32.dll")]
	public static extern IntPtr GetConsoleWindow();
	
	[DllImport("user32.dll")]
	public static extern bool ShowWindow(IntPtr hWnd, Int32 nCmdShow);
	'
	$consolePtr = [Console.Window]::GetConsoleWindow()
	[Console.Window]::ShowWindow($consolePtr, 0)
}

hideConsole
#Build the GUI
[xml]$xaml = @"
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:local="clr-namespace:CM_Deployment_Status"
        Title="" Height="410" Width="571.423" MinWidth="400" MinHeight="100" ResizeMode="NoResize">
    <Grid>
        <Rectangle Fill="#FF1BA1E2" Stroke="#FF1BA1E2" RenderTransformOrigin="0.506,0.917"/>
        <Button x:Name="btnInstall" Content="Install" Margin="436,72,0,0" FontWeight="Bold" FontSize="14" Background="White" Foreground="#FF1BA1E2" BorderBrush="#FF006CA0" RenderTransformOrigin="1,1" IsDefault="True" Width="102" Height="40" HorizontalAlignment="Left" VerticalAlignment="Top"/>
        <Label x:Name="lblMain" Content="Printer Installation Tool" Margin="15,8,0,0" Foreground="White" Height="46" FontSize="30" RenderTransformOrigin="0.5,0.5" FontWeight="SemiBold" TextOptions.TextHintingMode="Animated" HorizontalAlignment="Left" VerticalAlignment="Top" Width="323">
            <Label.RenderTransform>
                <TransformGroup>
                    <ScaleTransform/>
                    <SkewTransform AngleX="1.652"/>
                    <RotateTransform/>
                    <TranslateTransform X="0.721"/>
                </TransformGroup>
            </Label.RenderTransform>
        </Label>
        <Label x:Name="lblDepartment" Content="Department:" Margin="16,71,0,0" Foreground="White" Height="55" FontSize="16" RenderTransformOrigin="0.5,0.5" TextOptions.TextHintingMode="Animated" HorizontalAlignment="Left" VerticalAlignment="Top" Width="101">
            <Label.RenderTransform>
                <TransformGroup>
                    <ScaleTransform/>
                    <SkewTransform AngleX="1.652"/>
                    <RotateTransform/>
                    <TranslateTransform X="0.721"/>
                </TransformGroup>
            </Label.RenderTransform>
        </Label>
        <Label x:Name="lblPrinter" Content="Printer:" Margin="39,122,0,0" Foreground="White" Height="55" FontSize="16" RenderTransformOrigin="0.5,0.5" TextOptions.TextHintingMode="Animated" HorizontalAlignment="Left" VerticalAlignment="Top" Width="75">
            <Label.RenderTransform>
                <TransformGroup>
                    <ScaleTransform/>
                    <SkewTransform AngleX="1.652"/>
                    <RotateTransform/>
                    <TranslateTransform X="0.721"/>
                </TransformGroup>
            </Label.RenderTransform>
        </Label>
        <ComboBox x:Name="cmbDepartment" HorizontalAlignment="Left" Height="30" Margin="123,72,0,0" VerticalAlignment="Top" Width="270" TabIndex="1" Padding="4"/>
        <ComboBox x:Name="cmbPrinter" HorizontalAlignment="Left" Height="30" Margin="122,123,0,0" VerticalAlignment="Top" Width="270" TabIndex="2" Padding="4"/>
    </Grid>
</Window>
"@

Add-Type -AssemblyName PresentationFramework
$reader=(New-Object System.Xml.XmlNodeReader $xaml)
$Window=[Windows.Markup.XamlReader]::Load( $reader )
$window.Topmost = $true

#Connect to Controls 
$xaml.SelectNodes("//*[@*[contains(translate(name(.),'n','N'),'Name')]]")  | ForEach-Object {
	New-Variable  -Name $_.Name -Value $Window.FindName($_.Name) -Force
} 

    $depts = @(
    "ADG  Analytics & Data Governance",
    "BOS  Board of Supervisors",
    "CAC  County Administrator ",
    "CDN  Community Development & Neighborhood Conservation (CDNC)",
    "CED  Community Economic Development",
    "COB  Clerk of the Board",
    "CON  Constables",
    "CST  Community Services, Employment & Training (CSET)",
    "COM   Communications",
    "DEQ  Dept of Environmental Quality",
    "DSD  Developmental Services ",
    "EDT  Attractions & Tourism",
    "ELC  Elections",
    "FCD  Flood Control",
    "FMT  Facilities Management",
    "FIN  Finance & Risk Management",
    "FLT  Fleet",
    "FSC  Office of the Medical Examiner (Forensic Science Center)",
    "GGS  General Government Services Administration"
    "GMI  Grants Management & Innovation",
    "HLT  Health",
    "HRS  Human Resources",
    "IDS  Indigent Defense",
    "ITD  Information Technology",
    "JCA  Justice Court Ajo",
    "JCG  Justice Court Green Valley",
    "KSC  Stadium District",
    "LIB  Library",
    "OEM  Office of Emergency Management and Homeland Security",
    "OMS  Behavioral Health",
    "PAC  Pima Animal Care",
    "PDS  Public Defense Services",
    "PO  Procurement",
    "NRP  Natural Resources, Parks, and Recreation",
    "PW  Project Management Office",
    "RP  Real Property Services",
    "SOS  School Superintendent ",
    "SUS  Office of Sustainability and Conservation",
    "DOT  Dept of Transportation",
    "WIN  Wireless Integrated Network",
    "RWR  Regional Wastewater Reclamation Dept"
    )

$printers = @(
    "ADG-33N-001-C01",
    "ATT-HCH-001-P01",
    "ATT-HCH-002-C01",
    "ATT-HCH-002-P01",
    "BHV-ABR-003-C01",
    "BHV-ABR-003-P01",
    "BHV-ADC-001-P01",
    "BOS-33N-011-C01",
    "BOS-33N-111-P01",
    "BOS-33N-111-P02",
    "BOS-33N-111-P03",
    "BOS-33N-211-P01",
    "BOS-33N-311-P02",
    "BOS-ADE-011-C03",
    "CAC-ABR-003-C01",
    "CAC-ABR-003-C02",
    "CAC-ABR-003-P01",
    "CAC-ABR-003-P02",
    "CAC-ABR-003-P03",
    "CAC-ABR-004-C01",
    "CAC-ABR-004-P01",
    "CAC-BOA-019-P01",
    "CAC-BOA-019-P02",
    "CAO-ADE-005-C01",
    "CAO-ADE-010-C02",
    "CAO-ADE-010-P01",
    "CDN-KSC-003-C02",
    "CDN-KSC-003-C03",
    "CDN-KSC-003-P01",
    "CDN-KSC-003-P04",
    "CDN-KSC-003-P05",
    "CDN-KSC-003-P06",
    "CDN-PHC-001-C01",
    "CIP-PWB-002-P02",
    "COB-ADE-001-C01",
    "COB-ADE-005-C01",
    "COB-ADE-005-C02",
    "COB-BHY-001-C02",
    "COB-BHY-001-P01",
    "COB-BHY-001-P02",
    "COM-ADE-001-C01",
    "COM-PSC-001-C01",
    "COM-PSC-001-P01",
    "CON-PSC-0LL-C01",
    "CON-PSC-0LL-P01",
    "CST-INA-001-C01",
    "CST-INA-001-P01",
    "CST-INA-001-P02",
    "CST-INA-001-P04",
    "CST-JKE-001-C01",
    "CST-JKE-001-P01",
    "CST-JKE-001-P02",
    "CST-JKE-001-P04",
    "CST-JKE-001-P05",
    "CST-KSC-001-C01",
    "CST-KSC-001-C02",
    "CST-KSC-001-P01",
    "CST-KSC-001-P02",
    "CST-KSC-001-P03",
    "CST-KSC-002-C01",
    "CST-KSC-002-C02",
    "CST-KSC-002-P01",
    "CST-KSC-002-P02",
    "CST-KSC-002-P04",
    "CST-KSC-002-P05",
    "CST-KSC-002-P06",
    "CST-KSC-003-P03",
    "CST-LAS-001-C01",
    "CST-LAS-001-P02",
    "CST-LAS-001-P03",
    "CST-LAS-001-P04",
    "CST-LND-001-C01",
    "CST-LND-001-P01",
    "CST-LND-001-P02",
    "CST-LND-001-P03",
    "CST-PHC-001-C01",
    "CST-PHC-001-P01",
    "CST-PHC-001-P02",
    "CST-RNV-001-C02",
    "CST-RNV-001-C03",
    "CST-RNV-001-C04",
    "CST-RNV-001-P01",
    "CST-RNV-001-P02",
    "CST-RNV-001-P03",
    "CST-RNV-001-P04",
    "CST-RNV-001-P05",
    "CST-RNV-001-P06",
    "CST-VTC-001-C01",
    "CST-VTC-001-P02",
    "CST-YOS-002-C01",
    "CST-YOS-002-P01",
    "CWD-PHC-001-C02",
    "DEQ-33N-007-C01",
    "DEQ-33N-007-C02",
    "DEQ-33N-007-P01",
    "DEQ-33N-007-P02",
    "DEQ-33N-007-P03",
    "DEQ-33N-007-P04",
    "DEQ-33N-007-P06",
    "DEQ-33N-007-P09",
    "DEQ-BOA-007-C01",
    "DEQ-BOA-007-C02",
    "DEQ-BOA-007-P01",
    "DEQ-BOA-007-P02",
    "DEQ-BOA-007-P03",
    "DEQ-BOA-007-P04",
    "DEQ-BOA-007-P06",
    "DEQ-BOA-007-P09",
    "DEQ-CPL-001-P01",
    "DEQ-INA-001-C01",
    "DOT-AJO-001-C01",
    "DOT-HOU-001-C01",
    "DOT-HOU-001-P01",
    "DOT-MIS-010-C01",
    "DOT-MIS-010-C03",
    "DOT-MIS-010-C04",
    "DOT-MIS-011-C01",
    "DOT-MIS-011-C02",
    "DOT-MIS-011-C03",
    "DOT-MIS-011-P07",
    "DOT-MIS-014-C01",
    "DOT-MIS-014-P01",
    "DOT-MIS-024-C01",
    "DOT-MIS-024-C02",
    "DOT-MIS-028-C01",
    "DOT-MIS-028-P01",
    "DOT-MIS-028-P02",
    "DOT-PWB-004-C01",
    "DOT-PWB-004-C02",
    "DOT-PWB-004-C03",
    "DOT-PWB-004-C05",
    "DOT-PWB-004-P01",
    "DOT-PWB-004-P02",
    "DOT-PWB-004-P04",
    "DOT-PWB-004-P09",
    "DOT-PWB-005",
    "DOT-PWB-005-C02",
    "DOT-PWB-005-C021",
    "DOT-PWB-005-C03",
    "DOT-PWB-005-C04",
    "DOT-PWB-005-C05",
    "DOT-PWB-005-C06",
    "DSD-PWB-001-C01",
    "DSD-PWB-002-C02",
    "EDT-PWB-002-C01",
    "ELC-ECC-001-C01",
    "ELC-ECC-001-C02",
    "ELC-ECC-001-P01",
    "ELC-ECC-001-P02",
    "ELC-ECC-001-P04",
    "ELC-ECC-001-P05",
    "ELC-ECC-001-P06",
    "FCD-PWB-007-C01",
    "FCD-PWB-007-P01",
    "FCD-PWB-009-C01",
    "FCD-PWB-009-C02",
    "FCD-PWB-009-C03",
    "FCD-PWB-009-P01",
    "FCD-PWB-009-P02",
    "FIN-ADE-006-C01",
    "FIN-ADE-006-C02",
    "FIN-ADE-007-C01",
    "FIN-ADE-007-C02",
    "FIN-ADE-007-P01",
    "FIN-ADE-008-C01",
    "FIN-ADE-008-C02",
    "FIN-ADE-008-P04",
    "FIN-ADE-009-C02",
    "FIN-ADE-00B-C01",
    "FIN-ADE-00B-P01",
    "FIN-ADE-00B-P02",
    "FIN-BOA-006-C01",
    "FIN-BOA-006-C02",
    "FIN-BOA-006-C04",
    "FIN-BOA-006-P04",
    "FIN-MIS-010-P01",
    "FIN-PWB-005-C01",
    "FIN-PWB-005-P01",
    "FIN-PWB-005-P02",
    "FIN-PWB-007-C01",
    "FIN-PWB-007-C02",
    "FIN-PWB-007-C03",
    "FLT-MIS-001-C01",
    "FLT-MIS-001-C02",
    "FLT-MIS-001-C03",
    "FLT-MIS-001-C04",
    "FLT-MIS-001-P01",
    "FLT-MIS-001-P02",
    "FLT-MIS-001-P03",
    "FLT-MIS-001-P04",
    "FLT-MIS-007-P03",
    "FLT-MIS-012-P01",
    "FLT-MIS-012-P02",
    "FMT-ABR-001-P01",
    "FMT-ADC-001-C01",
    "FMT-ADW-003-C01",
    "FMT-ADW-003-C02",
    "FMT-ADW-003-C03",
    "FMT-ADW-003-C04",
    "FMT-ADW-00A-P01",
    "FMT-ADW-00A-P02",
    "FMT-ADW-00A-P03",
    "FMT-ADW-00A-P04",
    "FMT-ADW-00A-P05",
    "FMT-ADW-00A-P06",
    "FMT-ADW-00B-C01",
    "FMT-ADW-00B-P01",
    "FMT-ADW-00B-P02",
    "FMT-ADW-00B-P03",
    "FMT-CPL-001-P01",
    "FMT-HCH-002-P01",
    "FMT-PSC-001-C01",
    "FSC-ABR-001-C01",
    "FSC-ABR-001-P01",
    "FSC-ABR-001-P02",
    "FSC-ABR-001-P03",
    "FSC-ABR-001-P04",
    "FSC-ABR-001-P05",
    "FSC-ABR-001-P06",
    "GGS-BOA-001-C01",
    "GMI-ADE-003-C01",
    "GMI-ADE-003-C02",
    "GMI-ADE-004-C01",
    "GMI-ADE-004-C02",
    "GMI-ADE-004-P03",
    "HLT-ABR-001-C01",
    "HLT-ABR-001-C02",
    "HLT-ABR-001-C03",
    "HLT-ABR-001-C05",
    "HLT-ABR-001-C06",
    "HLT-ABR-001-C07",
    "HLT-ABR-001-P01",
    "HLT-ABR-002-C01",
    "HLT-ABR-002-C02",
    "HLT-ABR-002-C03",
    "HLT-ABR-002-C04",
    "HLT-ABR-002-C05",
    "HLT-ABR-002-C06",
    "HLT-ABR-002-C07",
    "HLT-ABR-002-C08",
    "HLT-ABR-002-C10",
    "HLT-ABR-002-C11",
    "HLT-ABR-002-C12",
    "HLT-ABR-002-C13",
    "HLT-ABR-002-P01",
    "HLT-ABR-002-P02",
    "HLT-ABR-002-P03",
    "HLT-ABR-002-P04",
    "HLT-ABR-002-P05",
    "HLT-ABR-002-P06",
    "HLT-ABR-003-C01",
    "HLT-ABR-003-C02",
    "HLT-ABR-003-P02",
    "HLT-ABR-003-P03",
    "HLT-ABR-WIC-C01",
    "HLT-APH-WHS-C01",
    "HLT-APH-WHS-P01",
    "HLT-CAT-001-P01",
    "HLT-FLW-001-C01",
    "HLT-HCE-001-C01",
    "HLT-HCE-001-C02",
    "HLT-HCE-001-P01",
    "HLT-HCE-WIC-C01",
    "HLT-HCE-WIC-P01",
    "HLT-HCN-001-C01",
    "HLT-HCN-001-C02",
    "HLT-HCN-001-P03",
    "HLT-HCS-WIC-C01",
    "HLT-HCT-001-C01",
    "HLT-HCT-001-C02",
    "HLT-HCT-001-C03",
    "HLT-HCT-001-P01",
    "HLT-HCT-001-P04",
    "HLT-HCT-001-P06",
    "HLT-TBC-001-C01",
    "HLT-TBC-001-P02",
    "HLT-TBC-001-P03",
    "HLT-WHS-001-C01",
    "HLT-WHS-001-P01",
    "HRS-33N-001-C01",
    "HRS-ABR-002-P01",
    "HRS-ADW-004-C02",
    "HRS-ADW-004-C03",
    "HRS-ADW-004-C04",
    "HRS-ADW-004-P01",
    "HRS-ADW-004-P02",
    "HRS-ADW-004-P06",
    "IDS-AJO-003-C03",
    "IDS-AJO-003-P01",
    "IDS-AJO-003-P02",
    "IDS-AJO-003-P03",
    "IDS-AJO-003-P04",
    "IDS-BOA-010-C02",
    "IDS-BOA-010-P04",
    "IDS-BOA-010-P05",
    "IDS-BOA-016-C01",
    "IDS-BOA-016-C02",
    "IDS-BOA-016-P02",
    "IDS-BOA-018-P01",
    "IDS-BOA-019-P06",
    "IDS-BOA-020-C02",
    "IDS-BOA-020-P02",
    "IDS-BOA-020-P03",
    "IDS-BOA-020-P04",
    "IDS-BOA-022-C01",
    "IDS-BOA-022-C02",
    "IDS-BOA-022-P01",
    "IDS-BOA-022-P02",
    "IDS-BOA-022-P03",
    "ITD-ADW-006-C01",
    "ITD-ADW-006-P02",
    "ITD-ADW-006-P03",
    "ITD-BOA-012-C01",
    "ITD-BOA-012-P01",
    "ITD-BOA-012-P02",
    "ITD-BOA-014-C01",
    "ITD-BOA-014-C02",
    "ITD-BOA-014-P01",
    "ITD-BOA-015-C01",
    "ITD-BOA-015-P01",
    "ITD-BOA-015-P02",
    "ITD-BOA-015-P03",
    "ITD-BOA-017-C01",
    "ITD-BOA-017-P02",
    "ITD-BOA-018-C01",
    "ITD-BOA-018-P01",
    "ITD-MIS-027-C01",
    "JCT-GVY-001-C01",
    "JCT-GVY-001-C02",
    "JCT-GVY-001-P01",
    "JCT-GVY-001-P02",
    "KSD-KSD-001-C01",
    "KSD-KSD-001-C02",
    "KSD-KSD-001-P01",
    "KSD-KSD-002-C01",
    "KSD-KSD-002-P01",
    "LIB-ADC-002-C01",
    "LIB-ADC-002-P01",
    "LIB-ADC-002-P02",
    "LIB-COL-001-C01",
    "LIB-FLW-001-C01",
    "LIB-GLF-001-C01",
    "LIB-GVY-001-C01",
    "LIB-HIM-001-C01",
    "LIB-MAI-001-P01",
    "LIB-MAI-002-C01",
    "LIB-MAI-002-P01",
    "LIB-MAI-003-C01",
    "LIB-MAI-003-P02",
    "LIB-MAI-004-C01",
    "LIB-MAI-004-C02",
    "LIB-MAI-004-C03",
    "LIB-MAI-004-P01",
    "LIB-MAI-004-P03",
    "LIB-MAI-004-P07",
    "LIB-MAI-004-P09",
    "LIB-MIS-001-C01",
    "LIB-NAN-001-C01",
    "LIB-SAH-001-C01",
    "LIB-SLIB-001-C01",
    "LIB-VAL-001-C01",
    "LIB-WDS-001-C01",
    "LIB-WIL-001-C01",
    "NRP-AJO-001-C01",
    "NRP-BFN-001-C01",
    "NRP-BFN-001-C02",
    "NRP-CHR-001-P01",
    "NRP-ELT-001-P01",
    "NRP-RVR-001-C01",
    "NRP-RVR-001-C02",
    "NRP-RVR-001-P05",
    "NRP-RVR-002-C01",
    "NRP-RVR-002-P04",
    "NRP-RVR-002-P05",
    "NRP-RVR-00W-C01",
    "NRP-SHR-001-P01",
    "OEM-EOC-001-C01",
    "OEM-EOC-001-C02",
    "OEM-EOC-001-P01",
    "OEM-EOC-001-P04",
    "OEM-EOC-001-P05",
    "OEM-PEC-001-P06",
    "OSC-PWB-006-C01",
    "OSC-PWB-006-C02",
    "OSC-PWB-006-P01",
    "PAC-ACC-001-C01",
    "PAC-ACC-001-C02",
    "PAC-ACC-001-C03",
    "PAC-ACC-001-C04",
    "PAC-ACC-001-C05",
    "PAC-ACC-001-C06",
    "PAC-ACC-001-C07",
    "PAC-ACC-001-P01",
    "PAC-ACC-001-P02",
    "PAC-ACC-001-P03",
    "PAC-ACC-001-P04",
    "PAC-ACC-001-P05",
    "PAC-ACC-001-P06",
    "PAC-ACC-001-P11",
    "PAC-ACC-001-P12",
    "PAC-ACC-001-P13",
    "PAC-PEC-001-P01",
    "PCW-PEC-001-C01",
    "PDS-ADC-001-P01",
    "PDS-BOA-008-C01",
    "PDS-BOA-008-P01",
    "PDS-BOA-009-C01",
    "PDS-BOA-009-C02",
    "PDS-BOA-009-P01",
    "PDS-BOA-009-P02",
    "PDS-BOA-009-P03",
    "PDS-BOA-010-C01",
    "PDS-BOA-016-P01",
    "PDS-BOA-018-C01",
    "PDS-BOA-018-C02",
    "PDS-BOA-019-C01",
    "PDS-BOA-019-C02",
    "PDS-BOA-019-C03",
    "PDS-BOA-019-C04",
    "PDS-BOA-020-C01",
    "PDS-BOA-020-C02",
    "PDS-BOA-021-C01",
    "PDS-BOA-021-C02",
    "PDS-BOA-021-C03",
    "PDS-BOA-021-P01",
    "PDS-BOA-022-C01",
    "PDS-JDC-001-C01",
    "PDS-LDD-001-C01",
    "PDS-LDD-001-P01",
    "PDS-LSB-004-C01",
    "PDS-LSB-005-C01",
    "PFD-LSB-004-P01",
    "PFD-LSB-004-P02",
    "PFD-LSB-004-P03",
    "PFD-LSB-005-P01",
    "PFD-LSB-005-P02",
    "PFD-LSB-005-P03",
    "PMO-PWB-002-C01",
    "PRO-ADW-005-C01",
    "PRO-ADW-005-C02",
    "PRO-ADW-005-C03",
    "PRO-ADW-005-P01",
    "PRO-ADW-005-P02",
    "RLP-PWB-006-C01",
    "RLP-PWB-006-P02",
    "RWR-AVV-001-C01",
    "RWR-AVV-001-P02",
    "RWR-CDT-001-C01",
    "RWR-CLC-00A-C01",
    "RWR-CLC-00A-C02",
    "RWR-CLC-00A-C03",
    "RWR-CLC-00A-P01",
    "RWR-CLC-00A-P02",
    "RWR-CLC-00A-P03",
    "RWR-CLC-00A-P05",
    "RWR-CLC-00A-P06",
    "RWR-CLC-00A-P07",
    "RWR-CLC-00B-C01",
    "RWR-CLC-00B-P01",
    "RWR-CLC-00B-P02",
    "RWR-CLC-00C-C01",
    "RWR-CLC-00C-P01",
    "RWR-CNV-001-C01",
    "RWR-CNV-001-C02",
    "RWR-CNV-001-C03",
    "RWR-CNV-001-C04",
    "RWR-CNV-001-C05",
    "RWR-CNV-001-C06",
    "RWR-CNV-001-C07",
    "RWR-CNV-001-P01",
    "RWR-CNV-001-P02",
    "RWR-CNV-001-P03",
    "RWR-CNV-001-P04",
    "RWR-CNV-001-P05",
    "RWR-CNV-001-P06",
    "RWR-CNV-001-P07",
    "RWR-CNV-001-P08",
    "RWR-CNV-001-P09",
    "RWR-CNV-001-P12",
    "RWR-CNV-001-P13",
    "RWR-GVY-001-C01",
    "RWR-INA-001-C01",
    "RWR-INA-001-C04",
    "RWR-INA-001-C05",
    "RWR-INA-001-C06",
    "RWR-INA-001-P01",
    "RWR-INA-001-P02",
    "RWR-INA-001-P03",
    "RWR-INA-001-P04",
    "RWR-INA-001-P05",
    "RWR-INA-001-P06",
    "RWR-INA-001-P07",
    "RWR-INA-002-C01",
    "RWR-INA-002-C02",
    "RWR-INA-002-P01",
    "RWR-INA-002-P02",
    "RWR-INA-014-P02",
    "RWR-INA-016-C01",
    "RWR-INA-016-P01",
    "RWR-INA-016-P02",
    "RWR-INA-028-P01",
    "RWR-INA-034-P01",
    "RWR-INA-086-P01",
    "RWR-INA-088-C01",
    "RWR-INA-088-C02",
    "RWR-INA-088-P01",
    "RWR-INA-101-C01",
    "RWR-MIS-009-C03",
    "RWR-MIS-009-P01",
    "RWR-MIS-017-C01",
    "RWR-MIS-017-C02",
    "RWR-OLF-001-C02",
    "RWR-OLF-001-P01",
    "RWR-PWB-003-C02",
    "RWR-PWB-003-C04",
    "RWR-PWB-003-P01",
    "RWR-PWB-003-P05",
    "RWR-PWB-003-P06",
    "RWR-PWB-003-P07",
    "RWR-PWB-003-P08",
    "RWR-PWB-008-C01",
    "RWR-PWB-008-C03",
    "RWR-PWB-008-C04",
    "RWR-PWB-008-C05",
    "RWR-PWB-008-P01",
    "RWR-PWB-008-P02",
    "RWR-PWB-008-P03",
    "RWR-PWB-008-P04",
    "RWR-SRF-001-C01",
    "SOS-JAI-578-C01",
    "SOS-JAI-578-P01",
    "SOS-JDC-178-P01",
    "SOS-JDC-212-C01",
    "SOS-JDC-212-C02",
    "SOS-JDC-212-P01",
    "SOS-JDC-412-P01",
    "SOS-JDC-612-P01"
)

$depts| Sort-Object |ForEach-Object{$cmbDepartment.AddChild($_)}
$printers | Sort-Object | ForEach-Object{$cmbPrinter.AddChild($_)}

$cmbDepartment.Text = $depts | Where-Object { if(($_.split("  ")[0] -match $sccmD).count -eq 1){$_.split("  ")[0] -match $sccmD} else{($_.split("  ")[0] -match $sccmD.substring(0,2))[0]}}

$btnInstall.Add_Click({
    if($cmbDepartment.SelectedItem -eq $null -and $cmbUsage.SelectedItem -eq $null){
        [System.Windows.Forms.MessageBox]::Show("Verify that you have selected all required items.")
    }
        
        $creds = Get-Credential -Message 'Username example: "central\username" or "community\username"' 
        Import-Module "$ADModPath\ActiveDirectory\ActiveDirectory.psd1" -ErrorAction Continue -PassThru -Verbose
        Set-ADComputer "$compname" -Location $Location -Credential $creds
        Start-Sleep -Seconds 3
        Rename-Computer -NewName $lblcName.Content -DomainCredential $creds -Restart -Force
        $Window.Close()
})

$cmbDepartment.Add_SelectionChanged{

    $cmbPrinter.items.Clear()
    $depPrinters = @()
    
    foreach ($printer in $printers) {
        if ($cmbDepartment.SelectedValue.split("  ")[0].trim() -eq $printer.split("-")[0].trim()){
            $depPrinters += ,$printer
        }
    }

    $depPrinters | Sort-Object | ForEach-Object{$cmbPrinter.AddChild($_)}
}

$cmbDepartment.Focus()

hideConsole
$Null = $Window.ShowDialog()